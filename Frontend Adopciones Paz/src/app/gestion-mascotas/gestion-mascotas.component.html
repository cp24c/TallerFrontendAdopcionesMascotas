<app-navbar></app-navbar>
<div class="container mt-4">
  <h2 class="text-center">Gesti√≥n de Mascotas</h2>

  <div *ngIf="mascotas.length === 0" class="alert alert-warning text-center mt-4">
    No hay mascotas disponibles en este momento.
  </div>

  <div *ngIf="mascotas.length > 0" class="table-responsive mt-4">
    <table class="table table-striped table-bordered">
      <thead>
        <tr>
          <th class="bg-success bg-gradient text-white align-middle">#</th>
          <th class="bg-success bg-gradient text-white align-middle">Nombre</th>
          <th class="bg-success bg-gradient text-white align-middle">Especie</th>
          <th class="bg-success bg-gradient text-white align-middle">Raza</th>
          <th class="bg-success bg-gradient text-white align-middle">Edad</th>
          <th class="bg-success bg-gradient text-white align-middle">Sexo</th>
          <th class="bg-success bg-gradient text-white align-middle">Contacto</th>
          <th class="bg-success bg-gradient text-white align-middle">Estado</th>
          <th class="bg-success bg-gradient text-white align-middle">Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let mascota of mascotas; let i = index">
          <td>{{ i + 1 }}</td>
          <td>{{ mascota.nombre }}</td>
          <td>{{ mascota.especie }}</td>
          <td>{{ mascota.raza }}</td>
          <td>{{ mascota.edad }}</td>
          <td>{{ mascota.sexo }}</td>
          <td>{{ mascota.contacto }}</td>
          <td>{{ mascota.estadoAdopcion }}</td>
          <td>
            <button class="btn btn-warning btn-sm" (click)="editarMascota(mascota, modalEdit)">
              Editar
            </button>
            <button class="btn btn-danger btn-sm ms-1" (click)="eliminarMascota(mascota.idMascota)">
              Eliminar
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Modal para editar la mascota -->
  <ng-template #modalEdit let-modal>
    <div class="modal-header">
      <h5 class="modal-title">Editar Mascota</h5>
      <button
        type="button"
        class="btn-close"
        (click)="modal.dismiss()"
      ></button>
    </div>
    <div class="modal-body">
      <form #editarMascotaForm="ngForm">
        <!-- Fila con Nombre y Especie -->
        <div class="row mb-3">
          <div class="col-md-6">
            <label for="nombre" class="form-label">Nombre</label>
            <input
              type="text"
              class="form-control"
              id="nombre"
              [(ngModel)]="mascotaSeleccionada.nombre"
              name="nombre"
              required
            />
          </div>
          <div class="col-md-6">
            <label for="especie" class="form-label">Especie</label>
            <input
              type="text"
              class="form-control"
              id="especie"
              [(ngModel)]="mascotaSeleccionada.especie"
              name="especie"
              required
            />
          </div>
        </div>

        <!-- Fila con Raza y Sexo -->
        <div class="row mb-3">
          <div class="col-md-6">
            <label for="raza" class="form-label">Raza</label>
            <input
              type="text"
              class="form-control"
              id="raza"
              [(ngModel)]="mascotaSeleccionada.raza"
              name="raza"
              required
            />
          </div>
          <div class="col-md-6">
            <label for="sexo" class="form-label">Sexo</label>
            <select
              [(ngModel)]="mascotaSeleccionada.sexo"
              name="sexo"
              class="form-select"
              id="sexo"
              required
            >
              <option value="" disabled selected>Selecciona el sexo</option>
              <option value="Macho">Macho</option>
              <option value="Hembra">Hembra</option>
            </select>
          </div>
        </div>

        <!-- Fila con Edad y Contacto -->
        <div class="row mb-3">
          <div class="col-md-6">
            <label for="edad" class="form-label">Edad</label>
            <input
              type="number"
              class="form-control"
              id="edad"
              [(ngModel)]="mascotaSeleccionada.edad"
              name="edad"
              required
            />
          </div>
          <div class="col-md-6">
            <label for="contacto" class="form-label">Contacto</label>
            <input
              type="text"
              class="form-control"
              id="contacto"
              [(ngModel)]="mascotaSeleccionada.contacto"
              name="contacto"
              required
            />
          </div>
        </div>

      </form>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-secondary" (click)="modal.dismiss()">
        Cancelar
      </button>
      <button
        type="button"
        class="btn btn-success bg-gradient"
        (click)="guardarCambiosMascota(modal)"
        [disabled]="editarMascotaForm.invalid"
      >
        Guardar cambios
      </button>
    </div>
  </ng-template>
</div>
